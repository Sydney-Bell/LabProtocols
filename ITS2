#Made a project directory
mkdir 2bRAD_RTT
cd 2bRAD_RTT

#Made a directory for raw reads
mkdir rawreads

#Downloading reads
wget "https://launch.basespace.illumina.com/CLI/latest/amd64-linux/bs" -O $HOME/bin/bs
chmod +x ~/bin/bs

#Go to the website and confirm authorization by logging in to your basespace acct.
bs auth

#Making a script to download the reads and merge samples across 2 NovaSeq lanes


echo '#!/bin/bash' > downloadReads.sh
echo 'bs download project --concurrency=high -q -n JA22302 -o ~/ITS2_RTT/rawreads' >> downloadReads.sh
# -n is the project name and -o is the output directory

echo "find . -name '*.gz' -exec mv {} . \;" >> downloadReads.sh
echo 'rmdir SA*' >>downloadReads.sh
echo 'mkdir ../concatReads' >> downloadReads.sh
echo 'cp *.gz ../concatReads' >> downloadReads.sh
echo 'cd ../concatReads' >> downloadReads.sh
echo 'mergeReads.sh -o mergeTemp' >> downloadReads.sh
# -o is the directory to put output files in

echo 'rm *L00*' >> downloadReads.sh
echo "find . -name '*.gz' -exec mv {} . \;" >> downloadReads.sh
echo 'gunzip *.gz' >> downloadReads.sh
echo 'rmdir mergeTemp' >> downloadReads.sh

chmod +x downloadReads.sh

launcher_creator.py -b 'srun downloadReads.sh' -n downloadReads -q shortq7 -t 06:00:00 -e sydneybell2021@fau.edu
sbatch downloadReads.slurm

#How many reads before filtering?

echo '#!/bin/bash' >rawReads
echo readCounts.sh -e .fastq -o rttRaw >>rawReads
